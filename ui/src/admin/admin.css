/* Admin Layout */
.admin-layout {
  display: flex;
  min-height: 100vh;
}

.admin-sidebar {
  width: 220px;
  background: var(--dark-800);
  border-right: 1px solid var(--dark-700);
  display: flex;
  flex-direction: column;
  padding: 1.25rem 0;
  position: fixed;
  top: 0; left: 0; bottom: 0;
  z-index: 100;
}

.admin-logo {
  padding: 0 1.25rem 1.25rem;
  border-bottom: 1px solid var(--dark-700);
}
.admin-logo h2 { margin: 0; font-size: 1.1rem; color: var(--accent-primary); font-weight: 700; }
.admin-logo .muted { font-size: 0.7rem; color: var(--mid-500); }

.admin-nav { list-style: none; padding: 0.5rem 0; margin: 0; flex: 1; }
.admin-nav-btn {
  width: 100%;
  padding: 0.55rem 1.25rem;
  background: none;
  border: none;
  color: var(--mid-500);
  font-size: 0.85rem;
  font-family: inherit;
  cursor: pointer;
  text-align: left;
  transition: all 0.15s;
  border-left: 3px solid transparent;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}
.admin-nav-btn:hover { color: var(--light-300); background: rgba(204,120,92,0.04); }
.admin-nav-btn.active { color: var(--accent-primary); border-left-color: var(--accent-primary); background: rgba(204,120,92,0.08); }
.admin-nav-icon { font-size: 0.9rem; }
.admin-sidebar-footer { padding: 0.75rem 1.25rem; border-top: 1px solid var(--dark-700); }

.admin-main {
  flex: 1;
  margin-left: 220px;
  padding: 1.75rem;
  max-width: 1200px;
  overflow-x: hidden;
}

/* Admin Login */
.admin-login { display: flex; align-items: center; justify-content: center; min-height: 100vh; }
.admin-login-form {
  width: 100%; max-width: 360px;
  display: flex; flex-direction: column; gap: 0.75rem;
}
.admin-login-form h1 { margin: 0; color: var(--accent-primary); }

/* Stats Grid */
.admin-stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 0.75rem;
  margin-bottom: 1.25rem;
}
.admin-stat {
  display: flex; flex-direction: column; align-items: center;
  gap: 0.2rem; padding: 0.85rem;
}
.admin-stat-value { font-size: 1.5rem; font-weight: 700; color: var(--light-200); }
.admin-stat-label { font-size: 0.65rem; color: var(--mid-500); text-transform: uppercase; letter-spacing: 0.5px; }

/* Detail Grid */
.admin-detail-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 0.75rem;
  margin-top: 0.75rem;
}

/* ===== Tables ===== */
.admin-table { width: 100%; border-collapse: collapse; }
.admin-table th, .admin-table td {
  padding: 0.4rem 0.65rem;
  text-align: left;
  border-bottom: 1px solid var(--dark-700);
  overflow: hidden;
  text-overflow: ellipsis;
}
.admin-table th {
  color: var(--mid-500);
  font-weight: 500;
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  white-space: nowrap;
}
.admin-table-full { margin-top: 0.75rem; }

.table-fixed { table-layout: fixed; }
.table-fixed td { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

/* Fixed column widths */
.col-id       { width: 140px; }
.col-policy   { width: 120px; }
.col-claimant { width: 140px; }
.col-stage    { width: 140px; }
.col-status   { width: 100px; }
.col-date     { width: 140px; }
.col-time     { width: 100px; }
.col-agent    { width: 120px; }
.col-num      { width: 80px; text-align: right; }
.col-type     { width: 120px; }
.col-actor    { width: 80px; }
.col-hash     { width: 100px; }

.cell-ellipsis { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.cell-nowrap { white-space: nowrap; }

.text-right { text-align: right; }
.clickable { cursor: pointer; }
.clickable:hover { background: rgba(204, 120, 92, 0.04); }
.monospace { font-family: "SF Mono", Menlo, monospace; font-size: 0.8em; }

/* Sortable headers */
.sortable-th { cursor: pointer; user-select: none; transition: color 0.15s; }
.sortable-th:hover { color: var(--accent-primary); }
.sort-active { color: var(--accent-primary) !important; }

/* Truncated value + copy button */
.truncated-value { display: inline-flex; align-items: center; gap: 0.25rem; max-width: 100%; }
.truncated-text { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.copy-btn {
  flex-shrink: 0;
  background: none;
  border: 1px solid var(--dark-700);
  border-radius: 3px;
  color: var(--mid-500);
  font-size: 0.65rem;
  padding: 0 0.2rem;
  cursor: pointer;
  line-height: 1.2;
  transition: all 0.15s;
}
.copy-btn:hover { color: var(--accent-primary); border-color: var(--accent-primary); }

/* Status badges */
.status-badge {
  display: inline-block;
  padding: 0.12rem 0.45rem;
  border-radius: 4px;
  font-size: 0.7rem;
  font-weight: 600;
  text-transform: uppercase;
  white-space: nowrap;
}
.status-succeeded { background: rgba(90,154,107,0.15); color: var(--color-success); }
.status-failed { background: rgba(196,84,84,0.15); color: var(--color-error); }
.status-running { background: rgba(204,120,92,0.15); color: var(--accent-primary); }
.status-idle { background: rgba(90,154,107,0.1); color: var(--color-success); }
.status-disabled { background: rgba(102,102,99,0.15); color: var(--mid-600); }

.event-type-badge { padding: 0.08rem 0.35rem; border-radius: 3px; font-size: 0.65rem; font-weight: 600; white-space: nowrap; }
.event-type-stage-started { background: rgba(204,120,92,0.15); color: var(--accent-primary); }
.event-type-stage-completed { background: rgba(90,154,107,0.15); color: var(--color-success); }
.event-type-stage-error, .event-type-stage-failed { background: rgba(196,84,84,0.15); color: var(--color-error); }
.event-type-claim-created { background: rgba(212,162,127,0.15); color: var(--accent-secondary); }
.event-type-agent-input { background: rgba(204,120,92,0.1); color: var(--accent-primary); }
.event-type-agent-response { background: rgba(235,219,188,0.15); color: var(--accent-tertiary); }
.event-type-agent-raw-output { background: rgba(191,191,186,0.1); color: var(--mid-400); }
.event-type-schema-validation-failed { background: rgba(196,84,84,0.12); color: var(--color-error); }

/* Filters */
.admin-filters { display: flex; gap: 0.5rem; margin-bottom: 0.75rem; flex-wrap: wrap; align-items: center; }
.admin-filters input, .admin-filters select {
  padding: 0.4rem 0.65rem;
  background: var(--dark-900);
  border: 1px solid var(--dark-700);
  border-radius: var(--radius-sm);
  color: var(--light-200);
  font-size: 0.8rem;
  font-family: inherit;
  min-width: 0;
}
.admin-filters input { min-width: 140px; max-width: 200px; }
.admin-filters input::placeholder { font-size: 0.75rem; color: var(--mid-600); }
.admin-filters input:focus, .admin-filters select:focus {
  outline: none;
  border-color: var(--accent-primary);
}

/* JSON / pre */
.admin-json { font-size: 0.75rem; max-height: 400px; overflow: auto; white-space: pre-wrap; color: var(--mid-400); }
.admin-json-sm { font-size: 0.7rem; max-height: 200px; overflow: auto; white-space: pre-wrap; margin-top: 0.2rem; color: var(--mid-500); }

/* Run detail */
.run-detail-header { display: flex; justify-content: space-between; align-items: flex-start; margin: 0.75rem 0; }
.run-detail-title { margin: 0; font-size: 1.1rem; color: var(--accent-primary); font-weight: 700; }
.run-detail-stats .admin-stat-value { font-size: 1.1rem; }
.run-section { margin-top: 0.75rem; }
.admin-run-detail-header { display: flex; justify-content: space-between; align-items: center; }

/* Run timeline */
.run-timeline { position: relative; padding-left: 1.5rem; }
.run-timeline-item { position: relative; padding: 0.5rem 0; border-left: 2px solid var(--dark-700); padding-left: 1.25rem; }
.run-timeline-marker { position: absolute; left: -6px; top: 0.75rem; width: 10px; height: 10px; border-radius: 50%; background: var(--accent-primary); }
.marker-error { background: var(--color-error) !important; }
.marker-success { background: var(--color-success) !important; }
.marker-info { background: var(--accent-secondary) !important; }
.run-timeline-header { display: flex; gap: 0.75rem; align-items: center; }
.run-timeline-content { display: flex; flex-direction: column; gap: 0.3rem; }

/* Run I/O sections */
.run-io-section { margin-top: 0.3rem; }
.run-io-section summary { cursor: pointer; color: var(--accent-primary); font-size: 0.8rem; font-weight: 500; }
.run-io-pre {
  margin: 0.3rem 0 0;
  padding: 0.65rem;
  overflow-x: auto;
  font-size: 0.7rem;
  background: var(--dark-900);
  border-radius: var(--radius-sm);
  border: 1px solid var(--dark-700);
  color: var(--mid-400);
  white-space: pre-wrap;
  word-break: break-word;
  max-height: 300px;
  overflow-y: auto;
}
.run-event-meta {
  display: flex; gap: 1rem; flex-wrap: wrap;
  font-size: 0.75rem; color: var(--mid-500);
  margin-top: 0.2rem;
}
.run-event-meta code { color: var(--accent-secondary); }
.run-event-error {
  padding: 0.4rem 0.65rem;
  background: rgba(196,84,84,0.1);
  border-radius: var(--radius-sm);
  color: var(--color-error);
  font-size: 0.75rem;
  margin-top: 0.2rem;
}

/* Run output cards */
.run-output-cards { display: grid; grid-template-columns: 1fr; gap: 0.4rem; margin-top: 0.3rem; }
.run-output-card {
  padding: 0.5rem;
  background: var(--dark-900);
  border-radius: var(--radius-sm);
  border: 1px solid var(--dark-700);
}
.run-output-card dt { font-size: 0.7rem; font-weight: 600; color: var(--accent-secondary); text-transform: uppercase; letter-spacing: 0.04em; margin-bottom: 0.15rem; }
.run-output-card dd { margin: 0; font-size: 0.8rem; color: var(--light-300); word-break: break-word; }
.run-output-card dd pre { margin: 0; font-size: 0.7rem; }

/* Live indicator */
.live-indicator { color: var(--color-error); font-weight: 700; animation: pulse 1.5s infinite; }
@keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }

/* Agent cards */
.admin-agents-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem; }
.admin-agents-header h2 { margin: 0; color: var(--accent-primary); }
.admin-agents-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 0.75rem; }
.admin-agent-card { padding: 1rem; }
.admin-agent-disabled { opacity: 0.45; }
.admin-agent-header { display: flex; justify-content: space-between; align-items: center; }
.admin-agent-header h3 { margin: 0; font-size: 0.9rem; }
.admin-agent-meta { display: grid; grid-template-columns: auto 1fr; gap: 0.2rem 0.75rem; margin-top: 0.5rem; font-size: 0.8rem; }
.admin-agent-meta dt { color: var(--mid-500); }
.admin-agent-form { display: flex; gap: 0.5rem; flex-wrap: wrap; align-items: flex-end; margin-bottom: 1rem; }
.admin-agent-form input { flex: 1; min-width: 140px; }

/* Agent pipeline flow */
.agent-pipeline-flow {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0;
  overflow-x: auto;
  padding: 1rem 0;
  margin-bottom: 1rem;
}
.agent-pipeline-node-wrapper { display: flex; align-items: center; }
.agent-pipeline-node {
  display: flex; align-items: center; gap: 0.5rem;
  padding: 0.6rem 0.85rem;
  min-width: 110px;
  border: 1px solid var(--dark-700);
  transition: all 0.2s;
}
.agent-pipeline-node:hover { border-color: var(--accent-primary); }
.agent-pipeline-working { border-color: var(--accent-primary); box-shadow: 0 0 8px rgba(204,120,92,0.2); }
.agent-pipeline-disabled { opacity: 0.4; }
.agent-pipeline-info { display: flex; flex-direction: column; }
.agent-pipeline-info strong { font-size: 0.75rem; }
.agent-pipeline-info .muted { font-size: 0.6rem; }
.agent-pipeline-arrow { padding: 0 0.7rem; color: var(--mid-600); font-size: 1.1rem; }

/* Agent status dot */
.agent-status-dot {
  width: 8px; height: 8px;
  border-radius: 50%;
  display: inline-block;
  flex-shrink: 0;
}
.agent-status-pulse { animation: pulse-dot 2s infinite; }
@keyframes pulse-dot {
  0%, 100% { box-shadow: 0 0 0 0 rgba(204,120,92,0.4); }
  50% { box-shadow: 0 0 0 4px rgba(204,120,92,0); }
}

/* Stage stepper */
.stage-stepper {
  display: flex;
  align-items: center;
  gap: 0;
  padding: 1rem 0;
  overflow-x: auto;
  margin-bottom: 0.75rem;
}
.stage-step {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.3rem;
  min-width: 80px;
  flex: 1;
  position: relative;
}
.stage-step::after {
  content: "";
  position: absolute;
  top: 5px;
  left: 50%;
  width: 100%;
  height: 2px;
  background: var(--dark-700);
  z-index: 0;
}
.stage-step:last-child::after { display: none; }
.stage-step-done::after { background: var(--color-success); }
.stage-step-current::after { background: var(--accent-primary); }
.stage-step-dot {
  width: 12px; height: 12px;
  border-radius: 50%;
  background: var(--dark-700);
  z-index: 1;
  border: 2px solid var(--dark-700);
}
.stage-step-done .stage-step-dot { background: var(--color-success); border-color: var(--color-success); }
.stage-step-current .stage-step-dot { background: var(--accent-primary); border-color: var(--accent-primary); box-shadow: 0 0 6px rgba(204,120,92,0.4); }
.stage-step-label { font-size: 0.55rem; color: var(--mid-500); text-align: center; text-transform: uppercase; }
.stage-step-done .stage-step-label { color: var(--color-success); }
.stage-step-current .stage-step-label { color: var(--accent-primary); font-weight: 600; }

/* Claim detail in admin */
.claim-detail-header {
  display: flex; align-items: center; gap: 1rem;
  margin: 0.75rem 0;
}
.claim-detail-header h2 { margin: 0; font-size: 1.2rem; color: var(--accent-primary); }
.claim-kv {
  display: grid;
  grid-template-columns: auto 1fr;
  gap: 0.3rem 1rem;
  font-size: 0.8rem;
  margin: 0;
}
.claim-kv dt { color: var(--mid-500); font-weight: 500; }
.claim-kv dd { margin: 0; color: var(--light-300); overflow: hidden; text-overflow: ellipsis; }
.claim-desc-wrap { white-space: pre-wrap; word-break: break-word; max-width: 400px; }

/* Events list */
.admin-events-list { max-height: 400px; overflow-y: auto; }
.admin-event-item { display: flex; gap: 0.5rem; padding: 0.35rem 0; border-bottom: 1px solid var(--dark-700); font-size: 0.8rem; align-items: center; }
.admin-event-type { font-weight: 600; min-width: 140px; }
.admin-run-item { display: flex; gap: 0.5rem; align-items: center; padding: 0.35rem 0; border-bottom: 1px solid var(--dark-700); font-size: 0.8rem; }

/* Audit layout */
.audit-layout { display: grid; grid-template-columns: 240px 1fr; gap: 0.75rem; }
@media (max-width: 800px) { .audit-layout { grid-template-columns: 1fr; } }
.audit-claims-panel { max-height: 600px; overflow-y: auto; }
.audit-claims-panel h3 { margin: 0 0 0.5rem; font-size: 0.85rem; color: var(--accent-secondary); }
.audit-claims-list { display: flex; flex-direction: column; gap: 0; }
.audit-claim-item {
  display: flex; justify-content: space-between; align-items: center;
  padding: 0.4rem 0.5rem;
  border-bottom: 1px solid var(--dark-700);
  font-size: 0.75rem;
  transition: all 0.1s;
  gap: 0.5rem;
}
.audit-claim-item:hover { background: rgba(204,120,92,0.04); }
.audit-claim-active { background: rgba(204,120,92,0.1) !important; border-left: 2px solid var(--accent-primary); }

/* Overview */
.overview-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
.overview-header h2 { margin: 0; color: var(--accent-primary); }

/* Utility */
.btn-sm { padding: 0.25rem 0.5rem; font-size: 0.75rem; }
.btn-danger { background: rgba(196,84,84,0.15); color: var(--color-error); border: 1px solid rgba(196,84,84,0.3); }
.btn-danger:hover { background: rgba(196,84,84,0.25); }

/* Test comparison */
.comparison-diff-row { background: rgba(196,84,84,0.06) !important; }
.comparison-diff-row:hover { background: rgba(196,84,84,0.1) !important; }

/* Damage Photos Gallery */
.damage-photos-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 0.75rem;
  margin-top: 0.75rem;
}
.damage-photo-thumb {
  border-radius: var(--radius-sm);
  border: 1px solid var(--dark-700);
  overflow: hidden;
  background: var(--dark-900);
  cursor: pointer;
  transition: border-color 0.15s;
}
.damage-photo-thumb:hover { border-color: var(--accent-primary); }
.damage-photo-thumb img {
  width: 100%;
  height: 150px;
  object-fit: cover;
  display: block;
}
.damage-photo-thumb .photo-filename {
  padding: 0.25rem 0.5rem;
  font-size: 0.65rem;
  color: var(--mid-500);
  font-family: "SF Mono", Menlo, monospace;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.damage-photo-lightbox {
  position: fixed;
  inset: 0;
  z-index: 1000;
  background: rgba(0,0,0,0.85);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}
.damage-photo-lightbox img {
  max-width: 90vw;
  max-height: 90vh;
  border-radius: var(--radius-md);
  box-shadow: 0 4px 32px rgba(0,0,0,0.6);
}

/* Web Search Evidence */
.web-search-evidence { display: flex; flex-direction: column; gap: 0.75rem; margin-top: 0.5rem; }
.ws-block { display: flex; flex-direction: column; gap: 0.3rem; }
.ws-label { font-size: 0.7rem; font-weight: 600; color: var(--accent-secondary); text-transform: uppercase; letter-spacing: 0.04em; }
.ws-queries { margin: 0; padding-left: 1.25rem; font-size: 0.8rem; color: var(--light-300); }
.ws-queries li { margin-bottom: 0.15rem; }
.ws-citations { display: flex; flex-direction: column; gap: 0.5rem; }
.ws-citation { padding: 0.5rem; background: var(--dark-900); border: 1px solid var(--dark-700); border-radius: var(--radius-sm); }
.ws-citation-url { color: var(--accent-primary); font-size: 0.8rem; word-break: break-all; }
.ws-citation-excerpt { margin: 0.25rem 0 0; font-size: 0.75rem; color: var(--mid-400); line-height: 1.4; }

/* Loading */
.admin-loading { display: flex; align-items: center; justify-content: center; min-height: 100vh; color: var(--mid-500); }
